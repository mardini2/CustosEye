<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!--
  goal: cookie consent settings page for CustosEye website. allows users to accept or decline
        analytics cookies, displays their current choice, and stores the preference in localStorage.
        this page is separate from the consent modal and provides a dedicated settings interface.
-->
<!doctype html>
<html lang="en">

<head>
  <!-- standard metadata -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- title -->
  <title>Cookie Settings - CustosEye</title>

  <!-- SEO and structured metadata -->
  <meta name="description" content="Manage your CustosEye cookie preferences. Control analytics consent anytime for a better browsing experience." />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://www.custoseye.com/cookies.html" />

  <!-- Open Graph (social preview) -->
  <meta property="og:title" content="Cookie Settings - CustosEye" />
  <meta property="og:description" content="Manage or update your CustosEye cookie preferences anytime for full control over analytics." />
  <meta property="og:url" content="https://www.custoseye.com/cookies.html" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://www.custoseye.com/assets/favicon.png" />

  <!-- Favicon -->
  <link rel="icon" href="https://www.custoseye.com/assets/favicon.png" type="image/png" />
  <link rel="icon" href="assets/favicon.ico?v=2" sizes="any" />

  <!-- shared styles -->
  <link rel="stylesheet" href="styles.css?v=2" />
  <link rel="preload" href="styles.css?v=2" as="style" />
</head>

<body class="page">
  <!-- slim royal-purple stripe for polish -->
  <div class="top-stripe" aria-hidden="true"></div>

  <!-- header: logo + brand + navigation -->
  <header class="topbar">
    <!-- logo is a link back home -->
    <a class="home-link" href="/" aria-label="Go to homepage">
      <img class="logo" src="assets/favicon.png" alt="CustosEye logo" />
    </a>

    <!-- title + tagline are also a link back home -->
    <a class="home-link brand" href="/" aria-label="Go to homepage">
      <h1>CustosEye</h1>
      <p class="tagline">Your Third Eye</p>
    </a>

    <!-- main navigation: primary site sections only -->
    <nav class="topbar-nav" role="menubar" aria-label="Main navigation">
      <a href="index.html" role="menuitem">Home</a>
      <span class="nav-sep">|</span>
      <div class="nav-has-submenu">
        <a href="#" role="menuitem" aria-haspopup="true" aria-expanded="false" id="about-menu-button" tabindex="0">About</a>
        <div class="nav-submenu" role="menu" aria-labelledby="about-menu-button">
          <a href="about.html" role="menuitem">About</a>
          <a href="methodology.html" role="menuitem">Methodology</a>
          <a href="ethics.html" role="menuitem">Code of Ethics</a>
        </div>
      </div>
      <span class="nav-sep">|</span>
      <a href="download.html" role="menuitem">Downloads</a>
      <span class="nav-sep">|</span>
      <a href="documentation.html" role="menuitem">Documentation</a>
    </nav>
  </header>

  <!-- main content -->
  <main class="wrap">
    <!-- cookie settings card: accept/decline buttons and status display -->
    <section class="card">
      <h2 style="margin-bottom:8px">Cookie settings</h2>

      <!-- neutral copy; no details about intent -->
      <p class="muted" style="margin-bottom:16px">
        Your choice helps us provide a better site experience. You can change this any time below.
      </p>

      <!-- accept/decline buttons for cookie consent -->
      <div class="btn-row" style="margin-top:8px">
        <button class="btn btn-primary" id="accept-cookies">Accept cookies</button>
        <button class="btn btn-ghost" id="decline-cookies">Decline</button>
      </div>

      <!-- where we reflect the current stored state (shows "accepted", "declined", or "no choice") -->
      <div id="cookie-status" class="muted" style="margin-top:12px"></div>
    </section>
  </main>

  <!-- footer: legal and consent links (cookie settings page shows cookie settings as selected, not a link) -->
  <footer class="foot">
    <nav class="foot-nav">
      <!-- cookie settings is shown as selected on this page (matches footer link style but not clickable) -->
      <span style="color: #c8d0dd;" aria-current="page">Cookie Settings</span>
      <a href="privacy.html">Privacy Policy</a>
      <a href="license.html">License</a>
    </nav>
    <small class="muted">Â© <span id="year"></span> CustosEye. All rights reserved.</small>
  </footer>

  <script>
    // write the current year in the footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // use the same key as the banner/index page (must match consent.js)
    const KEY = 'analytics_consent';
    const statusEl = document.getElementById('cookie-status');

    // helper to show the current choice (reads from localStorage and displays status)
    function setStatusText() {
      const v = localStorage.getItem(KEY);
      statusEl.textContent = v
        ? (v === 'granted' ? 'Status: accepted' : 'Status: declined')
        : 'Status: no choice stored yet';
    }

    // Accept => store 'granted', notify any listeners, update status
    document.getElementById('accept-cookies').addEventListener('click', () => {
      localStorage.setItem(KEY, 'granted');  // save acceptance to localStorage
      window.dispatchEvent(new Event('analytics:consent-granted'));  // fire event for analytics script
      setStatusText();  // update status display
    });

    // Decline => store 'denied', update status
    document.getElementById('decline-cookies').addEventListener('click', () => {
      localStorage.setItem(KEY, 'denied');  // save denial to localStorage
      setStatusText();  // update status display
    });

    // show initial state when page loads
    setStatusText();
  </script>

  <!-- navigation accessibility and keyboard support -->
  <script src="js/nav-accessibility.js?v=2"></script>

  <!-- Cookie banner (shows once until a choice is stored) -->
  <script src="js/consent.js?v=2"></script>

  <!-- GA attaches only after consent -->
  <script src="js/analytics-attach.js?v=2" defer></script>
</body>
</html>